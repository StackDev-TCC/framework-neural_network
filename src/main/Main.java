package main;

import activationfunctions.Sigmoid;
import activationfunctions.Step;
import kernel.*;
import network.mnist.*;

public class Main {

    public static void main(String[] args) throws Exception {

        NeuralNetwork nn = new NeuralNetwork();
        Layer l1 = new Layer(10);
        Layer l2 = new Layer(10);
        l1.setActivationFunction(new Sigmoid());
        l2.setActivationFunction(new Step());
        nn.addLayer(l1);
        nn.addLayer(l2);
        Mnist mnist = new Mnist();
        MNISTInputSamples mnistInputSamples = new MNISTInputSamples(mnist.getAllMnistData());
        mnistInputSamples.getSample(0);
        nn.attachInput(mnistInputSamples.getInput());
        MNISTOutput mnistOutput = new MNISTOutput();
        nn.attachOutput(mnistOutput);

        nn.training();
        System.out.println(nn.showInfo(false));



//        int[] arr = new int[]{70, 80, 65, 50, 3, 25, 23, 22, 21, 20, 19, 15, 14, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0};
//        String report = Report.generate(nn.showInfo(true), arr);
//        Report.reportPrint("report", report);
    }
}
